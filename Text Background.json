[{"_id":"Default-1588045113736","name":"Default","type":"script","creation_date":1588045113738,"expressions":[{"_id":"Text-Background-1588114280542","code":"app.beginUndoGroup(\"Add Background Text\");\n\nfunction truncateString(str, num) {\n  if (str.length <= num) {\n    return str\n  }\n  return str.slice(0, num) + ' ...'\n}\n\nvar curComp = app.project.activeItem;\n\n// Text Layer\nvar addTextBool = _ bool: Create Text? _;\nvar curText = _ layer: Text Layer _;\n\nif(curComp && addTextBool) {\n  curText = curComp.layers.addText(_ string: Your Text _);\n}\n\n// Padding\nvar paddingTopBottom = _ number: Padding Top & Bottom _;\nvar paddingLeftRight = _ number: Padding Left & Right _;\n\n// Color\nvar fillColor = _ color: Fill Color _;\nvar strokeColor = _ color: Stroke Color _;\n\nvar sliderControl = \"ADBE Slider Control\";\n\nvar groupName = \"Rectangle Box\";\nvar effectsName = \"Effects\";\nvar rectanglePathName = \"Rectangle Path 1\";\n\nif (curComp && curText) {\n\tvar shapeLayer = curComp.layers.addShape();\n\tshapeLayer.name = \"Text Box\";\n\tvar shapeGroup = shapeLayer.property(\"Contents\").addProperty(\"ADBE Vector Group\");\n\tshapeGroup.name = groupName;\n  shapeGroup.property(\"Contents\").addProperty(\"ADBE Vector Shape - Rect\");\n\n\tvar fill = shapeGroup.property(\"Contents\").addProperty(\"ADBE Vector Graphic - Fill\");\n\tfill.Color.setValue(fillColor);\n\tvar stroke = shapeGroup.property(\"Contents\").addProperty(\"ADBE Vector Graphic - Stroke\");\n\tstroke.Color.setValue(strokeColor);\n\t\n\t// Slider Control\n\tvar controllerTotalPad = shapeLayer.Effects.addProperty(sliderControl);\n  controllerTotalPad.name = \"Total Padding\";\n  shapeLayer.property(effectsName).property(controllerTotalPad.name)(1).expression = \"effect(\\\"Padding Top & Bottom\\\")(1) + effect(\\\"Padding Left & Right\\\")(1)\";\n  \n  var controllerPadTopBottom = shapeLayer.Effects.addProperty(sliderControl);\n  controllerPadTopBottom.name = \"Padding Top & Bottom\";\n  controllerPadTopBottom.Slider.setValue(paddingTopBottom);\n  \n  var controllerPadLeftRight = shapeLayer.Effects.addProperty(sliderControl);\n  controllerPadLeftRight.name = \"Padding Left & Right\";\n  controllerPadLeftRight.Slider.setValue(paddingLeftRight);\n  \n  var totalPaddingHeight = \"effect(\\\"Padding Top & Bottom\\\")(1)\";\n  var totalPaddingWidth = \"effect(\\\"Padding Left & Right\\\")(1)\";\n\t\n\t\n\t// Expression Sizes & Position\n\tvar expressionSize = \"x = thisComp.layer(\\\"\" + curText.name + \"\\\").sourceRectAtTime().width\" + \n\t\";y = thisComp.layer(\\\"\" + curText.name + \"\\\").sourceRectAtTime().height;\" + \n\t\"[x + \" + totalPaddingWidth + \", y + \" + totalPaddingHeight + \"];\";\n\t\n\tvar expressionPos = \"s=thisComp.layer(\\\"\" + curText.name + \"\\\");\" +\n                      \"w=s.sourceRectAtTime().width/2;\" +\n                      \"h=s.sourceRectAtTime().height/2;\" + \n                      \"l=s.sourceRectAtTime().left;\" +\n                      \"t=s.sourceRectAtTime().top;\" +\n                      \"[w+l,h+t];\";\n\t\n\t// Set expression to shapeLayer\n\tshapeLayer.content(groupName).content(rectanglePathName).size.expression = expressionSize;\n\tshapeLayer.content(groupName).content(rectanglePathName).position.expression = expressionPos;\n\t\n\t\n\t// If Using existing text layer\n\tif(!addTextBool){\n\t  var posText = curComp.layer(curText.name).property(\"Position\").value;\n\t  shapeLayer.property(\"Position\").setValue([posText[0], posText[1]]);\n\t}\n\t\n\t// Name Shape layer based on text\n\tshapeLayer.name += \" - \" + truncateString(curText.name, 10);\n\t\t\n\t// Set parent shape layer to text layer\n\tcurComp.layer(shapeLayer.name).parent = curText;\n\t\n\t// Set Position of Text to be center of comp\n\tcurText.property(\"position\").setValue([curComp.width/2, curComp.height/2]);\n\t\n\t// Move to last index\n\tshapeLayer.moveToEnd();\n}\n\n// Deselect All Layers\napp.executeCommand(2004);\n\napp.endUndoGroup();","name":"Text Background","documentation":"Text Background that always expand with the sourceText.\n\n> Make sure you select text layer to proceed","tags":["Text","Background","Layer","Button"],"last_update":1588138645140}]}]